\documentclass[11pt,letterpaper,doublespacing,titlepage]{article}
\usepackage{ifpdf}
\usepackage{setspace}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[margin=1.0in]{geometry}
\setlength{\parindent}{24px} % Default is 15pt
\usepackage{indentfirst}

\author{Ryan Himmelwright}
\title{A Model of  the Changes in Functional Connectivity Network Properties During the Descent to Sleep}

\begin{document}
\maketitle
\section{Introduction}
\par
 Modern scanning techniques can determine both the structural and functional connectivity of a brain network. After defining these biological networks, mathematical network analysis techniques can be applied to them in order to analyze and model the complex system. Using models allows the interaction between the parts of the system to be observed over time, rather then only at specific time stamps. For example, even in modern imaging studies, samples are taken every few minutes or seconds (find citation and clarify), only giving a picture of what is happening at those specific times. Models help show the changing dynamics of during the progression of time. As a result, new insight about how alternative states are achieved can be made. Traditionally, studies on network properties of the brain during the descent from an awake state to sleep state has consisted of looking at network properties of awake vs. sleep. For example, when the brain is in an unconscious state, like during sleep or under anesthesia, the small-world properties of the functional connectivity networks break down.(Uehara et al., 2013) This suggests functional connectivity might have to exhibit small-world properties for consciousness to occur. By modeling the connectivity networks during the descent to sleep, new ideas of how network interactions relate to sleep and consciousness might emerge.
\subsection{Networks}
\par
Whether they are artificial or emerge from nature, networks are everywhere. A network is simply a system where each elements is interconnected to varying degrees. Network analysis has helped to provide a system level view of problems, enabling solutions to be found in many different fields of research including the social sciences (Borgatti et al., 2009), molecular biology ( Aittokallio et al., 2006), algorithm design (Mirza et al. 2003), civil engineering (Deuerlein, 2008), and neuroscience (Roy et al., 2008). Specific modern examples of networks were analyzed by Humphries 'I\&' Gurney (2008) and include the relationships between film actors, scientific co-authorship, email messages, book purchases, Internet networks, the Macsaque cortex, and functional cortical connectivity, just to name a few (Humphries 'I\&' Gurney, 2008).

% Look at Humphries & Gurney Paper  → * Give an example of their analysis *

\par
Each network is unique and contains many defining properties. A few examples include number of nodes in the network, the degree to which nodes in a graph tend to cluster together, or  clustering coefficients, and the average number of steps in the shortest path from a node to any other node, or average path-length. These different properties change and dictate how the network transfers information and functions as a whole. By changing the parameters of the network, one can change the behavior of the network. For example, it has been shown that changing the number of nodes in a network network can affect its global connectivity (Joudaki et al., 2012). Different types of networks can then be classified by looking at the properties and resultant behavior of the network.
\subsection{Graph Theory}
\par
Graph theory is the mathematical method used to visually represent and analyze a group of relations or network. In graph theory, associations between vertices (or nodes), are visualized by connecting them with an edge. A vertex is drawn as a circle (usually with some sort if identification value written inside it), and an edge is drawn as a line connecting the circles. For example, in Figure 2, the circles represent the nodes n1-n4 and the lines between them are vertices which represent a connection between the two nodes.
\par
In an association map of the graph, each node’s connectivity is represented in a matrix where a 1 represents a connection and a 0 represents the absence of a connection. Each node is numbered and the rows and columns of a matrix correspond to the inputs and outputs of the connections. (Hadley et al., 2012) For example, in Figure 2, n1 has outputs to both n2 and n3, but not itself or n2. As a result, row 1 in the connectivity matrix is ( 0 , 1, 1, 0). For the first column, n4 is the only input to n1, and thus column one is consequently (0, 0, 0, 1). 
\par
Every graph contains a set of unique graph parameters that help to describe the graph. Some of these parameters include the node degree, clustering-coefficient, path-length, connection  density, and hubs. The node degree is the most fundamental graph parameter and is the number of connections (edges)  a node has to the rest of the network. If the closest neighboring nodes of a specific node are also connected to each other, they form a cluster. The clustering-coefficient quantifies the number of connections that exist between these closest neighbors of the node. Path length is simply defined as the minimum number of connections to get from one node to another. The connection density, is a proportion of the number of total actual connections in the graph compared to the number of total possible connections. Lastly, a hub is a node that has a high degree and thus connects to many other nodes. Hubs are important for keeping the average path-length of a network low because they provide short cuts to other hubs where many nodes that can be quickly reached.
\subsection{Types of Networks}
\par
Network graphs tend to range from regular to completely random networks. For a set number of nodes (n) and edges (k), a regular network is a network where each node has the same number of connections, and each connection is systematically connected to its closest neighbors. For example, in Figure 1, each node in the Regular network is connected to the closest four neighboring nodes. While this arrangement is conducive for short path-lengths between neighboring nodes, it is inefficient for reaching nodes on the other side of the network, because each cluster of nodes is only connected to the its adjacent node clusters. (Watts 'I\&' Strogatz, 1998).
\par
In contrast to the systematic and symmetrical structures of regular networks, completely random networks are created with the probability of p=1 that a node will connect to any other node in the network, rather than only the most adjacent ones. For example, while still having four connections per node, each node in the random graph of Figure 1 connects to completely random nodes regardless of their placement within the circle. While this structure may result in the short path-lengths between particular nodes regardless of their relative placement, the amount of clustering between nodes decreases, making neighboring communication inefficient compared to the regular network.  (Watts 'I\&' Strogatz, 1998).
\subsection{Small-word Networks}
\par
It has been observed that for intermediate levels of randomness ( 0 < p < 1),  network exhibit small-world behavior (Watts 'I\&' Strogatz, 1998). Systems with small-world behavior have clusters of highly interconnected nodes that are attached to other clusters through key hub nodes. This configuration allows distant nodes to be reached through a short path of hub nodes to reach the target node’s cluster, followed by a short connection to the target node. The combined characteristics of  high local clustering, as seen in the regular network, but with the short path-lengths seen in a random network provides an optimal means for connectivity and information transfer through the network. 
\subsection{Measures of Small-word Networks}
\par
As stated previously, there are many properties of networks which help to define the network's  structure and characteristic traits. Since small-world networks are defined as having a short average path-length with a characteristic high clustering coefficient, measures that assess the level of 'small-worldness' of a network should be based off of these two properties. One such measure is the network measurement 'S', devised by Mark D. Humphries 'I\&' Kevin Gurney (2008).  This measure has two forms, Sws  and S(delta), where Sws  uses the clustering coefficient defined by Watts 'I\&' Strogatz (1998), and Sws  uses another definition of network clustering based on transitivity that is often used for small world models. (Newman, Moore, 'I\&' Watts, 2000). 
\subsection{Calculating  Sws}
\par
For simplicity, in the following description I will refer to Sws  as simply S. The quantitative metric of 'small-world-ness' (S) is defined by the equation: ** Figures** 
\par
Where,**Add Figures** and Given a network G with n nodes and m edges, the value of S is calculated by comparing the clustering coefficient, CWS  ( the extent to which the neighbors of nodes are interconnected), and the mean minimal path-length over all node pairs, L, between G and an equivalent Erdös-Rényi (E-R) random graph with the same n and m. If the resultant S value is greater than 1 (S > 1), network G is considered a small-word network. The higher the S value, the higher the attributed 'small-world-ness'. (Humphries 'I\&' Gurney, 2008)
\subsection{Networks in the Brain}
\par
Networks arise everywhere in nature, especially in biological systems (McVittie, 2010). One particular system often analyzed is the brain, the epitome of biological networks. Analysis of brain networks is used most often in research regarding the structural or functional connectivity of the brain. Structural connectivity in the brain is the actually physical connectivity between neurons through axonal and dendritic connections. Functional connectivity on the other hand is the temporal pathway of activity which occurs in coordination with given task being completed. For example, while there are billions of physical, structural pathways leading from the retina to the rest of the brain, the functional pathway is the specific connections which show activity when one's eyes fixate on a specific stimulus. At this time we actually have more data on functional connectivity of the brain than structural connectivity because the techniques to determine large scale structural connection have just recently become available. While it is known that functional connectivity can, and often does, differ from the structural connectivity, it is not fully understood why or how this happens and current research aims to uncover how functional connectivity emerges within a structural network (Hlinka et al., 2012). Recent publications have shown that structural connectivity, and even functional connectivity, often exhibit small-world properties in humans (Bassett 'I\&' Bullmore, 2006).
\par
There has recently been a push for research on the connectivity of the brain. For example, one such project, focused solely on connectivity, is The Human Connectome Project. While the project intends to first look at structural connectivity, it recognizes that combined use of structural and functional imaging techniques offer the best experimental route towards a human connectome and a holistic understanding of the brain. (Sporns, Tononi, 'I\&' Kotter, 2005). Additionally, in April 2013, President Obama announced the new BRAIN Initiative, a large-scale project to map the activity of the brain. (Brooks, 2013)
\subsection{Techniques}
\par
In order to obtain a computational functional connectivity network model with which to research brain function, various techniques are used.  The most common techniques involve analysis of a network created using EEG and fMRI data. To obtain a functional network, correlations between signals from various brain regions are determined. This is usually done by calculating the Pearson product-moment correlation coefficient between the signals. Due to the high computational demands of preforming the correlation analysis on a voxel (volumetric pixel) by voxel method, correlations are usually found between one or a few “seed” regions with all other voxels in the brain (Duyn 2012). Calculating this correlation across time, the functional pathways are obtained and activity thresholds are applied in order to get a connectivity map of large areas of the brain to be used for graph theory analysis (Bullmore and Sporns 2009).  With the connectivity map constructed, different methods may be used to further analyze the network. Some methods previously used include cross-correlation analysis, coherence analysis, statistical parametric mapping, and clustering analysis methods like fuzzy clustering analysis or hierarchical clustering analysis (Kaiming et al., 2009).
\par
In addition to the functional connectivity that can be found using combined EEG and fMRI data, structural connectivity is often found using a technique called DTI. Diffusion Tensor Imaging, or DTI for short, allows the mapping of the diffusion of water molecules in biological tissues. In neuroscience, DTI is used to map white matter, or more specifically myleanated axon tracks, in order to map and visualize axonal pathways. By tracing these pathways, the structural connectivity of the region can be determined.
\subsection{Small-World Properties in the Brain}
\par
Once these connection matrices are obtained from temporal brain data, network analysis can be done in order to look for specific network properties including small world properties. Using similar techniques, it has been shown that small-world properties can exist within functional brain networks (Sporns 'I\&' Honey, 2006). 
\par
Considering small-word networks provide an optimal means of connectivity, it has been hypothesized that the brain networks of people with disorders resulting in impaired cognitive ability, may exhibit decreased small-world attributes. As a result, many researchers have looked at existence or prevalence of small-world properties in many brain conditions and disorders. For example, it has been shown that while the cortical networks of patients with Alzheimer’s Disease, or Mild Cognitive Impairment both exhibit small-world properties, the Alzheimer’s networks have the least prevalent small-world properties. Patients with Mild Cognitive Impairment, an intermediate condition between normal aging and Alzheimer’s, showed intermediate small-world measurements, while the brains normal patients without either condition exhibit the highest level of small-worldness (Yao et al., 2010).  Previous research has also shown that people with schizophrenia (Yong et al., 2008), children with ADHD (Wang et al., 2008), and adolescents with internet addiction (Hong et al., 2013) all exhibit disrupted small-word functional connectivity networks when compared to peers without the condition.
\subsection{Integration Theory of Consciousness}
\par
There are many theories about consciousness and what might be required for an organism to be consciousness or unconscious. One such theory is the Integration Theory of Consciousness Proposed by Giulio Tononi. Integration theory states that consciousness corresponds to the brain's capacity to integrate information across the brain network (Tononi, 2004). This means a minimal level of information integration might be needed in order to sustain consciousness: therefore, at times when a person is unconscious, such as in a sleep state or under anesthesia, this minimal level is not being reached. Since small-world structures offer an efficient means to integrate information across a network, if the integration theory of consciousness holds true, then small-word properties might be necessary for consciousness.
\par
Sleep is often used as a model for consciousness because the body enters an unresponsive state. If the small-world properties of the functional connectivity network break down during the onset of sleep, the level of information integration will also decrease, resulting in the loss of consciousness associated with sleep. By studying the changes in functional network properties of sleep, and applying the information integration theory of consciousness, new hypotheses about the biological mechanisms behind both sleep and consciousness can be inferred.
\subsection{Mechanisms of Sleep}
\par
Sleep, marked by decreased consciousness, decreased movement, and a slowed-down metabolism, is a universal phenomenon that all animals in the animal kingdom, including humans, experience. During sleep, there are characteristic activity changes in the nervous system that can be measured with electroencephalogram (EEG). Using similar techniques, Aserinsky and Kleitman observed regular periods of eye-movements during sleep. Ever since this observation, researchers have classified sleep into two distinct states, rapid eye movement (REM) and non-rapid eye movement (NREM) sleep (Aserinsky 'I\&' Kleitman, 1953). Non-rapid eye movement is further broken down into four separate stages, S1, S2, S3, and S4. It should be noted that stages 3  'I\&' 4 form a combined stage referred to as slow wave sleep (SWS), due to the greatly reduced frequency ( < 4 Hz) of the cortical waves during these stages. Throughout the period of sleep, the nervous system rotates through these states approximately every 90 minutes up to five or six times. Every cycle experiences both NREM and REM activity, but the relative amounts of activity differ as the cycles progress. The first cycle is predominately NREM activity and little REM activity, but by the last cycle, the cycle consists of mostly REM activity and little NREM activity.
\par
It is currently believed that sleep is a process orchestrated by the neurochemical process from sleep-promoting and arousal centers in the brain. From animals studies, it is known that wakefulness is promoted by brain stem and hypothalamic neurons. These networks are each capable of increasing wakefulness but coordinated activity in all these pathways is required for complete alertness and cortical activation. During SWS, these arousal systems are inhibited by GABA-nergic neurons that are co-distributed with many of the neurons contained in the arousal system. (Espana 'I\&' Scammell, 2004) The activation and inhibition of these key arousal systems may greatly alter the network properties of the brain.
\subsection{Networks During Sleep and Consciousness}
\par
While previous research has shown that functional connectivity does not drastically change between sleep and awake states (Larson-Prior et al., 2009), newer research using higher resolution connectivity maps suggests otherwise, showing that are connectivity differences between sleep and awake states. Recently, it was shown that during stage 1 sleep, the average path-length decreased compared to the awake state, thus decreasing the efficiency of the network. Not only did it decrease globally, but also in several specific regions depending on the conscious state (Uehara et al., 2013). This research suggests that a certain level of network efficiency might be needed in order to sustain consciousness. In addition, there may be key locations (node hubs) that decrease activity during the onset sleep or are targets of anesthesia, resulting in the decreased level of consciousness observed during these states. The thalamus is one suspected region, due to its role during the onset of sleep.
\subsection{TMS Studies}
\par
In addition to taking combined EEG and fMRI readings during normal states of brain function, other techniques can be used to study integration of information through a brain network. One of these techniques is employing trans-cranial magnetic stimulation (TMS) to the brain during different states of arousal. By administering TMS to the brain of a participant that has been anesthetized, it has been observed that the strength of the TMS signal quickly dies out when compared to the recordings of TMS applied to a conscious individual (Ferrarelli et at., 2010).  Activity induced by the TMS signal to a conscious brain spreads out across nearly the whole brain during a 295ms time span. However when the signal is applied to the anesthetized brain, it initially has the same or even greater strength as the signal in the conscious brain, but the signal remains localized and quickly dies out within 110 ms. This suggest while there may still be local clustering during an unconscious state, the connectivity between the clusters breaks down, increasing path-length and disrupting the small-word architecture. 
\section{Hypothesis}
\par
Studies have shown that the functional connectivity of a brain in an awake state has an architecture that exhibits small world properties. It has also been shown that during the onset of sleep, the average path-length of the network increases and local clustering remains high, causing these small world properties to break down. Combined with the results of TMS studies that showed the reduction of signal propagation through the network of an anesthetized brain, it could be said that the functional connectivity of an unconscious brain actually resembles an over-connected network. Additionally, the information integration theory of consciousness states that a minimal level of integration of the information moving through a network is needed to maintain consciousness. Using sleep as a model for consciousness, the breakdown of small world properties during the transition from an awake to sleep state may decrease the integration of information in the functional connectivity network, ultimately inducing the ‘unconscious’ state associated with sleep.
\par
Traditionally, most studies on the subject have only looked at the network properties prior to, and after the onset of sleep. The purpose of this model is to observe what might be happening to the functional connectivity of the network during the transition from awake to sleep. While the model implements an algorithm that should move the network step by step from a small-world graph to a regular graph, we do not know the path the network parameters will take through the space between these two states. While the starting and anticipated ending points for the small-world network parameters such as average path-length, clustering-coefficient, and S will be known, there are many ways the model can move between the starting and ending states. A network is a large, intricate, and complex system and every connection can drastically affect global information flow. Since connections that could change the network in any direction are slowly being changed over time, the transformational path might display a unique, but consistent behavior. It may change linearly with the network moving directly from the starting to  finishing state at a constant rate, it may oscillate, where is makes progress towards the final state, but has periods of backtracking, or it might move much until a critical point is reached where the network jumps through the state space to the end. 
\par
The purpose of this study if to observe how the model traverses through the state space in order to then extrapolate what the biological mechanism underlying the change in functional  connectivity between the conscious and unconscious states might entail. For example, if the model oscillates during the transition, the oscillation might coincide with the behavioral observation of the different sleep stages associated with the descent to sleep. This would help explain why we have a gradual staged descent to sleep rather than a straight transition. 
\section{Plan of Action}
\subsection{Building the Model}
\par
In order to create the network graphs, a free software package called igraph will be utilized as a library in the R statistical programming language. Igraph is used for creating and manipulating both undirected and directed graphs and provides many additional functions. These functions allow the generation of graphs with specific parameters, as well as the easy calculation of network properties such as average path length and the clustering coefficient. The packages also provide the ability to plot the graphs, adding a visual component to the data. Additionally, when igraph is used as a library in the R statistical programming language, statistical analysis can be directly applied to the network graphs through R’s many functions. 
\par
Using igraph, network exhibiting small-world properties will be randomly generated using the watts.strogatz.game() function (values yet to be determined. Possibly use a range of parameters, at least initially to get an idea of what areas to use). An erdos.renyi.game() function will also be used in conjunction with the watts.strogatz in order to create an equivalent Erdös-Rényi graph to use when calculating S. This starting small-world graph will represent the functional connectivity of the awake state. After the generation of the network, an external program will use a function to determine the ‘hubs’ of the network. When the hubs are detected, a new node node will be generated in the network and connected one-way to all the hubs. This node represents the thalamus, a key driver of the biological sleep mechanism. The thalamus node has one-way connections because it is driving the network, rather than acting as an ultimate hub node for it. At this point, the initial model is set up and can be run.
\subsection{The Algorithms which Drive the Model}
\par
The model runs by applying algorithms to the network. Specifically, a type of algorithm known as a 'hill-climbing search algorithm' will be used to driving the model forward. A hill-climbing search is a looped algorithm that moves a model through the parameter space in a direction of increasing value until it reaches a 'peak' value and terminates. The 'peak' can also be a minimum value, or 'valley' that the algorithm tries to optimize as well. For example, the function of the model is to move network from a state that exhibits small-world properties, to a state that is over-connected due to an increased average path-length and decreased S ( < 1, no longer exhibiting SWP)s . To drive this, a hill-climbing algorithm will be used to add edges until the network has an average path-length of a predefined goal value. Specifically, a stochastic hill climbing method called First-choice hill climbing will used. In this method, the algorithm randomly generates successors until a new network better than the current is created. In the model, this means that children networks will be generated by randomly removing or changing connections. If a generated child network has a greater average path-length and lower calculated S value, it will become the new parent. This is done until the optimum goal state is reached.
\par
The previous algorithm is often problematic in the fact that it may never finish due to the possibility of getting stuck on a local maxima (or minimum). When a model is traversing through the state space, there may be many local maxima that are not the global maxima. These are values that are optimized for the immediate area, but not for the overall state space. In the previous algorithm, if the state reaches a local maxima, it will assume it has found the optimal solution and terminate, never hitting the global optimal solution. One way to counteract this problem is by using a Random-restart hill climbing method. This algorithm will run a series of hill-climbing searches, restarting until the optimal goal is reached. In the model, this means hill-climbing searches will run with each hitting an optimum value. If that value does not meet our goal value, the search will be restarted with a new random initial state. The algorithm works on the idea that one of the times, it will start with ideal conditions to reach the goal state. If there are few local maxima to get stuck on, the algorithm will find a solution rather quickly. However, in cases that the state-space is much more rugged with many peaks and valleys,  the algorithm has an exponential number of local maxima which it can get stuck on. This is a problem that needs to be remembered when using such algorithms Still, a random-restart hill-climbing algorithm offers an improved way to reach a goal solution. (Russell, 2010)
\par
While I think the model will work best with using just a random-restart hill-climbing algorithm, I have also planned to possibly implement genetic algorithm components to the model if it is needed. Genetic algorithms are fairly similar to the hill-climbing algorithm I plan to use, except that the generated states also undergo a crossover and mutation. Genetic algorithms start with a set of randomly generated states. Each state is usually represented as a string that can be easily altered. In the model, the states would be multiple graphs generated by randomly adding edges to each one from the parent. The graphs will each be represented in an association connection matrix that is can be easily altered. Each of the states in this new generation of graphs is rated with a fitness function that returns higher values for better states and lower values for lower states, in relation to the goal value. In the model, the fitness function would be based on average path lengths and the calculated value S of the graphs. Graphs with a lower average path-length and S value will receive a higher fitness. Next the states are paired off randomly (or in a defined mechanism if desired) for reproduction. When mated, a crossover point is selected to divide the parents into two parts. Each child contains the first part from one parent and the second part from the other. In the model, this means a point in the connectivity matrix will be selected to divide the matrix. The children will have a connectivity matrix that consists of the first part coming from one parent and the second coming from the other parent. Lastly, before restarting the cycle with the children, the children are mutated. During mutation, points in the children are randomly selected and the values changed. This means the connectivity matrices of the children in the example will have a random connection or two selected and changed (ex: randomly picking a value of 0 and changing it to a 1, thus randomly adding a new connection). The children then go through the cycle, producing their own offspring. Over time, the individuals evolve through the state-space towards the desired solution. (Russell, 2010)
\par
I do not on plan on using the full genetic algorithms in the model right away because I am afraid the crossover and mutation may alter connections in the network in ways that will drastically deviate it from the biology. I would prefer to initially run the model with an algorithm that does not contain crossovers or mutations in the generated children, but simply makes random changes to the previous network instead. This ensures each generation of the network is a progression from the previous network and not the offspring of two networks that might have a topology that greatly differs from the previous state. However, if initial algorithm could be improved by adding these additions, I plan on doing so.
\subsection{Running the Model}
\par
The model operates by using the previously discussed hill-climbing algorithms to randomly move connections between the hubs, inward to the local clusters. This is done to represent the strengthening of the modulatory signals from the thalamus to the network, overpowering the inter-hub connections.  At each step, the network parameters average path-length, clustering-coefficient, and S will be recorded for later analysis. Using this mechanism, the model's algorithm will drive the global connectivity across the network to decrease and the average path-length to increase. Conversely, local clustering should remain high and even increase slightly. This matches what is seen in the biological research. In the TMS studies, when a stimulus was applied to an awake brain, the signal propagated across the brain to many different regions over time. When the stimulus was applied to the unconscious brain however, the stimulus spiked high in the local area, but quickly died out unable to reach other areas. The model will move these connections until the desired level of path-length and connectivity coefficients are reached. 
\par
The model will be run over a range of seeds to ensure that it produces consistent behavior. In addition, there will be two different setups the model will run. The first one is a basic condition that will only move single a connection during each every step. Since the different areas of the brain often operate in parallel rather than sequentially, a second state will be created that will change a few connections from different areas of the network during each step. There might not be a huge difference, if there is a difference at all, but it is something worth investigating.
\subsection{Analysis of the Data}
\par
First, for every seed, all the parameters will be plotted over time to determine 1) if a  consistent pattern emerges, and 2) if so, what type of pattern it is. Once the behavior is known, further analysis of the data can be completed using R. First, the data will be tested to see if it is statistically similar. The data will also be averaged and an equation fit to the plot. 
\par
*It should be noted that most of the data analysis will have to be determined after the model is run, as it is largely dependent on the  results*
% Add Refferences here somehow.
% Learn how to add figures after. (with 1 per page).

\end{document}
